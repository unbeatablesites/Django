{"ast":null,"code":"import _toConsumableArray from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/client/src/pages/Articles/Articles.js\";\nimport React, { Component } from \"react\";\nimport API from \"../../utils/API\";\nimport { Article } from '../../components/Article';\nimport Jumbotron from \"../../components/Jumbotron\";\nimport { H1, H3, H4 } from '../../components/Headings';\nimport { Container, Row, Col } from \"../../components/Grid\";\nimport { Panel, PanelHeading, PanelBody } from '../../components/Panel';\nimport { Form, Input, FormBtn, FormGroup, Label } from \"../../components/Form\";\n\nvar Articles =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Articles, _Component);\n\n  function Articles() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Articles);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Articles)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      topic: '',\n      //main search term\n      sYear: '',\n      //start year for search\n      eYear: '',\n      //end year for search\n      page: '0',\n      //page of search results\n      results: [],\n      //array of results returned from api\n      previousSearch: {},\n      //previous search term saved after search completed\n      noResults: false //boolean used as flag for conditional rendering\n\n    };\n\n    _this.saveArticle = function (article) {\n      //creating new article object\n      var newArticle = {\n        date: article.pub_date,\n        title: article.headline.main,\n        url: article.web_url,\n        summary: article.snippet //calling the API\n\n      };\n      API.saveArticle(newArticle).then(function (results) {\n        //removing the saved article from the results in state\n        var unsavedArticles = _this.state.results.filter(function (article) {\n          return article.headline.main !== newArticle.title;\n        });\n\n        _this.setState({\n          results: unsavedArticles\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.handleInputChange = function (event) {\n      var _event$target = event.target,\n          name = _event$target.name,\n          value = _event$target.value;\n\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.handleFormSubmit = function (event) {\n      event.preventDefault();\n      var _this$state = _this.state,\n          topic = _this$state.topic,\n          sYear = _this$state.sYear,\n          eYear = _this$state.eYear;\n      var query = {\n        topic: topic,\n        sYear: sYear,\n        eYear: eYear\n      };\n\n      _this.getArticles(query);\n    };\n\n    _this.getArticles = function (query) {\n      //clearing the results array if the user changes search terms\n      if (query.topic !== _this.state.previousSearch.topic || query.eYear !== _this.state.previousSearch.eYear || query.sYear !== _this.state.previousSearch.sYear) {\n        _this.setState({\n          results: []\n        });\n      }\n\n      var topic = query.topic,\n          sYear = query.sYear,\n          eYear = query.eYear;\n      var queryUrl = \"https://api.nytimes.com/svc/search/v2/articlesearch.json?sort=newest&page=\".concat(_this.state.page);\n      var key = \"&api-key=a9257b04f6e84033a42b8bdedbdd3b2a\"; //removing spaces and building the query url conditionally\n      //based on presence of optional search terms\n\n      if (topic.indexOf(' ') >= 0) {\n        topic = topic.replace(/\\s/g, '+');\n      }\n\n      if (topic) {\n        queryUrl += \"&fq=\".concat(topic);\n      }\n\n      if (sYear) {\n        queryUrl += \"&begin_date=\".concat(sYear);\n      }\n\n      if (eYear) {\n        queryUrl += \"&end_date=\".concat(eYear);\n      }\n\n      queryUrl += key; //calling the API\n\n      API.queryNYT(queryUrl).then(function (results) {\n        //concatenating new results to the current state of results.  If empty will just show results,\n        //but if search was done to get more, it shows all results.  Also stores current search terms\n        //for conditional above, and sets the noResults flag for conditional rendering of components below\n        _this.setState({\n          results: _toConsumableArray(_this.state.results).concat(_toConsumableArray(results.data.response.docs)),\n          previousSearch: query,\n          topic: '',\n          sYear: '',\n          eYear: ''\n        }, function () {\n          this.state.results.length === 0 ? this.setState({\n            noResults: true\n          }) : this.setState({\n            noResults: false\n          });\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.getMoreResults = function () {\n      var _this$state$previousS = _this.state.previousSearch,\n          topic = _this$state$previousS.topic,\n          eYear = _this$state$previousS.eYear,\n          sYear = _this$state$previousS.sYear;\n      var query = {\n        topic: topic,\n        eYear: eYear,\n        sYear: sYear //increments page number for search and then runs query\n\n      };\n      var page = _this.state.page;\n      page++;\n\n      _this.setState({\n        page: page\n      }, function () {\n        this.getArticles(query);\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Articles, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Container, {\n        fluid: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(Col, {\n        size: \"sm-10\",\n        offset: \"sm-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(Jumbotron, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(H1, {\n        className: \"page-header text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"Search for NYT Articles\"), React.createElement(H4, {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"Save articles you find interesting\")), React.createElement(Panel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(PanelHeading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(H3, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, \"Search\")), React.createElement(PanelBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(Form, {\n        style: {\n          marginBottom: '30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Label, {\n        htmlFor: \"topic\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"Enter a topic to search for:\"), React.createElement(Input, {\n        onChange: this.handleInputChange,\n        name: \"topic\",\n        value: this.state.topic,\n        placeholder: \"Topic\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      })), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(Label, {\n        htmlFor: \"sYear\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \"Enter a beginning date to search htmlFor (optional):\"), React.createElement(Input, {\n        onChange: this.handleInputChange,\n        type: \"date\",\n        name: \"sYear\",\n        value: this.state.sYear,\n        placeholder: \"Start Year\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      })), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(Label, {\n        htmlFor: \"eYear\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"Enter an end date to search for (optional):\"), React.createElement(Input, {\n        onChange: this.handleInputChange,\n        type: \"date\",\n        name: \"eYear\",\n        value: this.state.eYear,\n        placeholder: \"End Year\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      })), React.createElement(FormBtn, {\n        disabled: !this.state.topic,\n        onClick: this.handleFormSubmit,\n        type: \"info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, \"Submit\")))), this.state.noResults ? React.createElement(H1, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"No results Found.  Please try again\") : this.state.results.length > 0 ? React.createElement(Panel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(PanelHeading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(H3, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"Results\")), React.createElement(PanelBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, this.state.results.map(function (article, i) {\n        return React.createElement(Article, {\n          key: i,\n          title: article.headline.main,\n          url: article.web_url,\n          summary: article.snippet,\n          date: article.pub_date,\n          type: \"Save\",\n          onClick: function onClick() {\n            return _this2.saveArticle(article);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        });\n      }), React.createElement(FormBtn, {\n        type: \"warning\",\n        additional: \"btn-block\",\n        onClick: this.getMoreResults,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Get more results\"))) : '')));\n    }\n  }]);\n\n  return Articles;\n}(Component);\n\nexport { Articles as default };","map":{"version":3,"sources":["/Users/frankuzoka/Downloads/NNNYTReactSearch-master 2/client/src/pages/Articles/Articles.js"],"names":["React","Component","API","Article","Jumbotron","H1","H3","H4","Container","Row","Col","Panel","PanelHeading","PanelBody","Form","Input","FormBtn","FormGroup","Label","Articles","state","topic","sYear","eYear","page","results","previousSearch","noResults","saveArticle","article","newArticle","date","pub_date","title","headline","main","url","web_url","summary","snippet","then","unsavedArticles","filter","setState","catch","err","console","log","handleInputChange","event","target","name","value","handleFormSubmit","preventDefault","query","getArticles","queryUrl","key","indexOf","replace","queryNYT","data","response","docs","length","getMoreResults","marginBottom","map","i"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport API from \"../../utils/API\";\nimport { Article } from '../../components/Article'\nimport Jumbotron from \"../../components/Jumbotron\";\nimport { H1, H3, H4 } from '../../components/Headings';\nimport { Container, Row, Col } from \"../../components/Grid\";\nimport { Panel, PanelHeading, PanelBody } from '../../components/Panel';\nimport { Form, Input, FormBtn, FormGroup, Label } from \"../../components/Form\";\n\n\nexport default class Articles extends Component {\n  state = {\n    topic: '',//main search term\n    sYear: '',//start year for search\n    eYear: '',//end year for search\n    page: '0',//page of search results\n    results: [],//array of results returned from api\n    previousSearch: {},//previous search term saved after search completed\n    noResults: false,//boolean used as flag for conditional rendering\n  };\n\n\n  //function to save an article\n  saveArticle = (article) => {\n    //creating new article object\n    let newArticle = {\n      date: article.pub_date,\n      title: article.headline.main,\n      url: article.web_url,\n      summary: article.snippet\n    }\n\n    //calling the API\n    API\n      .saveArticle(newArticle)\n      .then(results => {\n        //removing the saved article from the results in state\n        let unsavedArticles = this.state.results.filter(article => article.headline.main !== newArticle.title)\n        this.setState({results: unsavedArticles})\n      })\n      .catch(err => console.log(err));\n  }\n\n  //capturing state of inputs on change\n  handleInputChange = event => {\n    let { name, value } = event.target;\n    this.setState({[name] : value})\n  };\n\n  //generating the query for the search from store state\n  handleFormSubmit = event => {\n    event.preventDefault();\n    let { topic, sYear, eYear } = this.state;\n    let query = { topic, sYear, eYear }\n    this.getArticles(query)\n\n  };\n\n  //function that queries the NYT API\n  getArticles = query => {\n    //clearing the results array if the user changes search terms\n    if (query.topic !== this.state.previousSearch.topic ||\n        query.eYear !==this.state.previousSearch.eYear ||\n        query.sYear !==this.state.previousSearch.sYear) {\n      this.setState({results: []})\n    }\n    let { topic, sYear, eYear } = query\n\n    let queryUrl = `https://api.nytimes.com/svc/search/v2/articlesearch.json?sort=newest&page=${this.state.page}`\n    let key = `&api-key=a9257b04f6e84033a42b8bdedbdd3b2a`\n\n    //removing spaces and building the query url conditionally\n    //based on presence of optional search terms\n    if(topic.indexOf(' ')>=0){\n      topic = topic.replace(/\\s/g, '+');\n    }\n    if (topic){\n      queryUrl+= `&fq=${topic}`\n    }\n    if(sYear){\n      queryUrl+= `&begin_date=${sYear}`\n    }\n    if(eYear){\n      queryUrl+= `&end_date=${eYear}`\n    }\n    queryUrl+=key;\n\n    //calling the API\n    API\n      .queryNYT(queryUrl)\n      .then(results => {\n          //concatenating new results to the current state of results.  If empty will just show results,\n          //but if search was done to get more, it shows all results.  Also stores current search terms\n          //for conditional above, and sets the noResults flag for conditional rendering of components below\n          this.setState({\n            results: [...this.state.results, ...results.data.response.docs],\n            previousSearch: query,\n            topic: '',\n            sYear: '',\n            eYear: ''\n          }, function (){\n            this.state.results.length === 0 ? this.setState({noResults: true}) : this.setState({noResults: false})\n          });\n      })\n      .catch(err=> console.log(err))\n  }\n\n  //function that is called when user clicks the get more results button\n  getMoreResults = () => {\n    let { topic, eYear, sYear} = this.state.previousSearch;\n    let query = { topic, eYear, sYear }\n    //increments page number for search and then runs query\n    let page = this.state.page;\n    page++\n    this.setState({page: page}, function (){\n      this.getArticles(query)\n    });\n  }\n\n  render() {\n    return (\n      <Container fluid>\n        <Row>\n          <Col size=\"sm-10\" offset='sm-1'>\n            <Jumbotron>\n              <H1 className='page-header text-center'>Search for NYT Articles</H1>\n              <H4 className='text-center'>Save articles you find interesting</H4>\n            </Jumbotron>\n            <Panel>\n              <PanelHeading>\n                <H3>Search</H3>\n              </PanelHeading>\n              <PanelBody>\n                <Form style={{marginBottom: '30px'}}>\n                  <FormGroup>\n                    <Label htmlFor=\"topic\">Enter a topic to search for:</Label>\n                    <Input\n                      onChange={this.handleInputChange}\n                      name='topic'\n                      value={this.state.topic}\n                      placeholder='Topic'\n                    />\n                  </FormGroup>\n                  <FormGroup >\n                    <Label htmlFor=\"sYear\">Enter a beginning date to search htmlFor (optional):</Label>\n                    <Input\n                      onChange={this.handleInputChange}\n                      type='date'\n                      name='sYear'\n                      value={this.state.sYear}\n                      placeholder='Start Year'\n                    />\n                  </FormGroup>\n                  <FormGroup >\n                    <Label htmlFor=\"eYear\">Enter an end date to search for (optional):</Label>\n                    <Input\n                      onChange={this.handleInputChange}\n                      type='date'\n                      name='eYear'\n                      value={this.state.eYear}\n                      placeholder='End Year'\n                    />\n                  </FormGroup>\n                  <FormBtn\n                    disabled={!(this.state.topic)}\n                    onClick={this.handleFormSubmit}\n                    type='info'\n                    >Submit\n                  </FormBtn>\n                </Form>\n              </PanelBody>\n            </Panel>\n            { this.state.noResults ?\n              (<H1>No results Found.  Please try again</H1>) :\n              this.state.results.length>0 ? (\n                <Panel>\n                  <PanelHeading>\n                    <H3>Results</H3>\n                  </PanelHeading>\n                  <PanelBody>\n                    {\n                      this.state.results.map((article, i) => (\n                          <Article\n                            key={i}\n                            title={article.headline.main}\n                            url={article.web_url}\n                            summary={article.snippet}\n                            date={article.pub_date}\n                            type='Save'\n                            onClick={() => this.saveArticle(article)}\n                          />\n                        )\n                      )\n                    }\n                      <FormBtn type='warning' additional='btn-block' onClick={this.getMoreResults}>Get more results</FormBtn>\n                  </PanelBody>\n                </Panel>\n              ) : ''\n            }\n          </Col>\n        </Row>\n      </Container>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}